<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logic101 | Lab</title>
    <style>
        :root {
            --bg: #050505;
            --discord-slate: #2f3136;
            --netflix-red: #e50914;
            --spotify-green: #1db954;
            --border: #1a1a1a;
            --font: -apple-system, sans-serif;
        }
        body { background: var(--bg); color: #fff; font-family: var(--font); margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        .back-nav { position: absolute; top: 20px; left: 20px; width: 40px; height: 40px; background: #111; border: 1px solid var(--border); border-radius: 50%; display: flex; align-items: center; justify-content: center; text-decoration: none; color: #fff; font-weight: bold; }
        #chat-interface { background: #0f0f0f; border-radius: 16px; height: 80vh; width: 100%; max-width: 550px; display: flex; flex-direction: column; border: 1px solid var(--border); margin-top: 60px; overflow: hidden; }
        #chat-history { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 15px; }
        .bubble { padding: 12px 16px; font-size: 14px; line-height: 1.5; border-radius: 12px; max-width: 85%; }
        .ai-bubble { background: var(--discord-slate); align-self: flex-start; border-bottom-left-radius: 2px; }
        .user-bubble { background: #111; align-self: flex-end; border: 1px solid var(--netflix-red); border-bottom-right-radius: 2px; }
        .input-area { background: #18191c; padding: 15px; border-top: 1px solid var(--border); }
        .input-wrap { background: #40444b; border-radius: 8px; display: flex; padding: 8px 12px; gap: 10px; }
        #user-input { flex: 1; background: transparent; border: none; color: #fff; outline: none; }
        .send-btn { background: var(--netflix-red); color: #fff; border: none; padding: 0 15px; border-radius: 6px; font-weight: 800; cursor: pointer; }
        code { display: block; background: #000; padding: 15px; border-radius: 8px; margin: 10px 0; color: var(--spotify-green); font-family: monospace; }
    </style>
</head>
<body>
    <a href="dashboard.html" class="back-nav"> < </a>
    <div id="chat-interface">
        <div id="chat-history"></div>
        <div class="input-area">
            <div class="input-wrap">
                <input type="text" id="user-input" placeholder="Enter logic..." onkeydown="if(event.key === 'Enter') runLogic()">
                <button class="send-btn" onclick="runLogic()">RUN</button>
            </div>
        </div>
    </div>

    <script>
        const KEY = "AIzaSyBFpT7_kIGrlCDWfSaXNkPUlBohNrfcrYg";
        let memory = [];

        async function runLogic() {
            const input = document.getElementById('user-input');
            const val = input.value.trim();
            if (!val) return;
            input.value = '';
            renderBubble('user', val);
            memory.push({ role: 'user', parts: [{ text: val }] });

            const sys = "You are ERTY. Dark Discord theme. One code block max. NO comments. One quiz question. If correct, start with LOGIC_VALIDATED.";

            try {
                const r = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${KEY}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: memory, systemInstruction: { parts: [{ text: sys }] } })
                });
                const d = await r.json();
                const txt = d.candidates[0].content.parts[0].text;
                renderBubble('ai', txt);
                memory.push({ role: 'model', parts: [{ text: txt }] });
            } catch (e) {
                renderBubble('ai', "SYSTEM_ERROR.");
            }
        }

        function renderBubble(role, text) {
            const h = document.getElementById('chat-history');
            const b = document.createElement('div');
            b.className = `bubble ${role}-bubble`;
            b.innerHTML = text.replace(/```([\s\S]*?)```/g, '<code>$1</code>');
            h.appendChild(b);
            h.scrollTop = h.scrollHeight;
        }
    </script>
</body>
</html>
